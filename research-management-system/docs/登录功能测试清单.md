# 登录功能测试检查清单

## 测试前准备

- [ ] 确保开发服务器正在运行 (`npm run dev`)
- [ ] 打开浏览器开发者工具的控制台
- [ ] 清空浏览器 localStorage (F12 → Application → Local Storage → Clear All)
- [ ] 刷新页面

## 测试用例 1: 管理员登录

### 测试数据
- 账号: `admin`
- 密码: `admin123`
- 预期角色: `admin`
- 预期跳转: `/admin/dashboard`

### 测试步骤
1. [ ] 打开登录页面
2. [ ] 点击"管理员"快捷标签(或手动输入账号密码)
3. [ ] 点击"登录"按钮
4. [ ] 观察控制台输出

### 预期结果
- [ ] 看到提示: "登录成功"
- [ ] 控制台输出: `✅ 登录成功: { username: '管理员', role: 'admin', ... }`
- [ ] 页面自动跳转到 `/admin/dashboard` (科研看台)
- [ ] 页面正常显示,不会跳转回登录页
- [ ] localStorage 中存在 `token` 和 `userInfo`

### 实际结果
- [ ] 通过 / [ ] 失败
- 失败原因: ___________

---

## 测试用例 2: 专家登录

### 测试数据
- 账号: `expert`
- 密码: `expert123`
- 预期角色: `expert`
- 预期跳转: `/expert/reviews`

### 测试步骤
1. [ ] 退出登录 (清空 localStorage)
2. [ ] 刷新页面回到登录页
3. [ ] 点击"专家"快捷标签
4. [ ] 点击"登录"按钮
5. [ ] 观察控制台输出

### 预期结果
- [ ] 看到提示: "登录成功"
- [ ] 控制台输出: `✅ 登录成功: { username: '审核专家', role: 'expert', ... }`
- [ ] 页面自动跳转到 `/expert/reviews` (成果审核)
- [ ] 页面正常显示,不会跳转回登录页

### 实际结果
- [ ] 通过 / [ ] 失败
- 失败原因: ___________

---

## 测试用例 3: 科研用户登录

### 测试数据
- 账号: `researcher`
- 密码: `researcher123`
- 预期角色: `researcher`
- 预期跳转: `/dashboard`

### 测试步骤
1. [ ] 退出登录 (清空 localStorage)
2. [ ] 刷新页面回到登录页
3. [ ] 点击"科研用户"快捷标签
4. [ ] 点击"登录"按钮
5. [ ] 观察控制台输出

### 预期结果
- [ ] 看到提示: "登录成功"
- [ ] 控制台输出: `✅ 登录成功: { username: '科研用户', role: 'researcher', ... }`
- [ ] 页面自动跳转到 `/dashboard` (个人概览)
- [ ] 页面正常显示,不会跳转回登录页

### 实际结果
- [ ] 通过 / [ ] 失败
- 失败原因: ___________

---

## 测试用例 4: 刷新页面保持登录

### 测试步骤
1. [ ] 使用任意账号登录成功
2. [ ] 刷新浏览器页面 (F5)
3. [ ] 观察页面状态

### 预期结果
- [ ] 页面刷新后仍然保持登录状态
- [ ] 不会跳转回登录页
- [ ] 用户信息正常显示

### 实际结果
- [ ] 通过 / [ ] 失败
- 失败原因: ___________

---

## 测试用例 5: 错误账号密码

### 测试数据
- 账号: `wronguser`
- 密码: `wrongpass`

### 测试步骤
1. [ ] 退出登录
2. [ ] 输入错误的账号密码
3. [ ] 点击"登录"按钮

### 预期结果
- [ ] 看到错误提示: "账号或密码错误"
- [ ] 不会跳转
- [ ] 可以继续尝试登录

### 实际结果
- [ ] 通过 / [ ] 失败
- 失败原因: ___________

---

## 测试用例 6: 权限检查

### 测试步骤
1. [ ] 以 `researcher` 身份登录
2. [ ] 手动访问 `/admin/dashboard` (在地址栏输入)
3. [ ] 观察页面反应

### 预期结果
- [ ] 被重定向到 `/403` (无权限页面)
- [ ] 或显示权限不足提示
- [ ] 控制台输出权限检查日志

### 实际结果
- [ ] 通过 / [ ] 失败
- 失败原因: ___________

---

## 调试技巧

### 查看 localStorage
```javascript
// 在浏览器控制台执行
console.log('Token:', localStorage.getItem('token'))
console.log('UserInfo:', JSON.parse(localStorage.getItem('userInfo')))
```

### 查看 Pinia Store 状态
```javascript
// 在浏览器控制台执行 (需要 Vue DevTools)
// 或在代码中添加
console.log('isLoggedIn:', userStore.isLoggedIn)
console.log('userInfo:', userStore.userInfo)
console.log('userRole:', userStore.userRole)
```

### 清空 localStorage
```javascript
// 在浏览器控制台执行
localStorage.clear()
location.reload()
```

---

## 问题排查清单

如果登录后仍然被退出,检查:

- [ ] 控制台是否有错误信息
- [ ] 是否显示 "✅ 登录成功" 日志
- [ ] localStorage 中是否保存了 token 和 userInfo
- [ ] 路由守卫是否输出了警告日志
- [ ] 网络请求是否成功 (Network 标签)
- [ ] userInfo 中的 role 字段是否正确

---

## 测试总结

**测试日期**: ___________  
**测试人员**: ___________  
**通过率**: _____ / 6  
**总体状态**: ⬜ 通过 / ⬜ 失败

### 主要问题
1. ___________
2. ___________
3. ___________

### 建议改进
1. ___________
2. ___________
3. ___________
