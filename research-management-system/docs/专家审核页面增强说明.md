# 专家审核页面增强说明

## 🎯 更新内容

### 2025年12月10日 - 轻量级增强 (方案1A)

本次更新为专家审核页面 (`/expert/reviews`) 新增了**成果所属项目信息展示**和**查看成果详情**的功能。

---

## ✨ 新增功能

### 1. 列表页增强

#### 待审核列表
在表格中新增**"所属项目"列**，显示格式：
- 有项目：`项目名称 (项目编号)`
- 无项目：`无所属/其他` (灰色文本)

#### 已审核列表
同样新增**"所属项目"列**，保持一致的展示风格。

**表格列顺序:**
```
| 成果名称 | 类型 | 所属项目 | 提交人 | 提交时间 | 操作 |
```

---

### 2. 审核对话框增强

#### 新增信息展示字段
审核对话框现在展示更完整的成果信息，包括：

| 字段 | 说明 |
|------|------|
| 标题 | 成果标题 |
| 类型 | 成果类型 (论文/专利等) |
| 年份 | 发表/申请年份 |
| **所属项目** | 项目名称 (项目编号) 或 "无所属/其他" |
| 提交人 | 成果提交者 |
| 提交时间 | 提交审核的时间 |
| 作者 | 成果作者列表 (逗号分隔) |
| 关键词 | 标签形式展示 |
| 摘要 | 多行文本展示，支持换行 |
| **附件列表** | 文件名、大小、下载按钮 |

#### 新增操作按钮
在对话框顶部右侧增加**"查看完整详情"**按钮：
- 点击后在**新标签页**打开成果详情页
- 不中断当前审核流程
- 方便专家深入了解成果全貌

---

## 🎨 界面优化

### 样式改进
1. **文本样式**
   - 添加 `.text-muted` 类，统一处理辅助文本 (灰色、13px)
   - 摘要内容支持换行和自动换行

2. **附件列表**
   - 卡片式展示，hover 时背景色变化
   - 图标 + 文件名 + 大小 + 下载按钮布局
   - 文件大小自动格式化 (B/KB/MB)

3. **对话框布局**
   - 宽度从 800px 增加到 900px，适应更多信息
   - 顶部操作栏与内容区分隔线分隔
   - 附件列表使用分隔线分区

---

## 📋 使用指南

### 审核流程

1. **查看待审核列表**
   - 进入"专家 → 成果审核"页面
   - 在待审核 Tab 查看待审核成果
   - 可快速识别成果所属项目

2. **点击"审核"按钮**
   - 弹出审核对话框
   - 查看成果的完整信息
   - 如需更多细节，点击"查看完整详情"按钮

3. **填写审核意见**
   - 在"审核意见"框输入评审内容
   - 选择"通过"或"驳回"
   - 点击"提交"完成审核

4. **查看已审核记录**
   - 切换到"已审核"Tab
   - 查看历史审核记录和结果

---

## 🔧 技术实现

### 新增依赖
```typescript
import { useRouter } from 'vue-router'
import { View, Document, Download } from '@element-plus/icons-vue'
```

### 新增函数
```typescript
// 查看成果详情 (新标签页打开)
function viewResultDetail()

// 格式化文件大小
function formatFileSize(bytes?: number)

// 下载附件
function downloadFile(file: any)
```

### 数据结构要求
成果对象需包含以下字段：
```typescript
{
  id: string
  title: string
  type: string
  year: string | number
  projectId?: string          // 项目ID
  projectName?: string        // 项目名称 ⭐ 新增
  projectCode?: string        // 项目编号 ⭐ 新增
  createdBy: string
  createdAt: string
  authors?: string[]          // 作者列表 ⭐ 新增
  keywords?: string[]         // 关键词 ⭐ 新增
  abstract?: string           // 摘要 ⭐ 新增
  attachments?: Array<{       // 附件列表 ⭐ 新增
    id: string
    name: string
    size?: number
    url: string
  }>
}
```

---

## 🧪 测试建议

### Mock 数据验证
项目中的 Mock 数据 (`src/mocks/data.ts`) 已包含测试数据：
- `r-001`: 有项目归属的成果
- `r-002`: 有项目归属的审核中成果
- `r-003`: 有项目归属的待审核成果
- `r-004`: 无项目归属的草稿成果

### 测试场景
1. ✅ 列表中正确显示项目信息
2. ✅ 无项目成果显示"无所属/其他"
3. ✅ 审核对话框展示完整信息
4. ✅ 附件列表正确显示和下载
5. ✅ "查看完整详情"按钮跳转正确
6. ✅ 文件大小格式化正确 (B/KB/MB)

### 启动测试
```bash
# 确保启用 Mock 数据
VITE_USE_MOCK=true

# 启动开发服务器
npm run dev

# 使用"专家"账号登录
用户名: expert
密码: expert123

# 访问审核页面
http://localhost:5173/expert/reviews
```

---

## 📝 注意事项

1. **后端接口对接**
   - 确保后端返回的成果数据包含 `projectName`、`projectCode`、`authors`、`keywords`、`abstract`、`attachments` 字段
   - 如果后端暂未提供，前端会显示默认值或"-"

2. **权限控制**
   - 仅专家和管理员角色可访问审核页面
   - 路由守卫已配置权限检查

3. **兼容性**
   - 所有新增字段都做了空值处理
   - 不会因为缺少字段导致页面报错

---

## 🚀 后续优化建议

1. **项目链接**
   - 考虑让"所属项目"可点击，跳转到该项目下的所有成果列表

2. **附件预览**
   - 对于 PDF/图片类型的附件，支持在线预览

3. **审核历史**
   - 在审核对话框中展示该成果的历史审核记录

4. **批量审核**
   - 支持勾选多个成果进行批量审核

---

## 📞 问题反馈

如有任何问题或改进建议，请联系开发团队。
